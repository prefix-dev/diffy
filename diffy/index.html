<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Tools for finding and manipulating differences between files"><title>diffy - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="diffy" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0 (ded5c06cf 2025-12-08)" data-channel="1.92.0" data-search-js="search-d69d8955.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Crate diffy</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../diffy/index.html">diffy</a><span class="version">0.4.2</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#overview" title="Overview">Overview</a></li><li><a href="#utf-8-and-non-utf-8" title="UTF-8 and Non-UTF-8">UTF-8 and Non-UTF-8</a></li><li><a href="#creating-a-patch" title="Creating a Patch">Creating a Patch</a></li><li><a href="#applying-a-patch" title="Applying a Patch">Applying a Patch</a></li><li><a href="#performing-a-three-way-merge" title="Performing a Three-way Merge">Performing a Three-way Merge</a></li></ul><h3><a href="#structs">Crate Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><h1>Crate <span>diffy</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/diffy/lib.rs.html#1-242">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Tools for finding and manipulating differences between files</p>
<h3 id="overview"><a class="doc-anchor" href="#overview">§</a>Overview</h3>
<p>This library is intended to be a collection of tools used to find and
manipulate differences between files inspired by <a href="http://www.xmailserver.org/xdiff-lib.html">LibXDiff</a> and <a href="https://www.gnu.org/software/diffutils/">GNU
Diffutils</a>. Version control systems like <a href="https://git-scm.com/">Git</a> and <a href="https://www.mercurial-scm.org/">Mercurial</a> generally
communicate differences between two versions of a file using a <code>diff</code> or
<code>patch</code>.</p>
<p>The current diff implementation is based on the <a href="http://www.xmailserver.org/diff2.pdf">Myers’ diff algorithm</a>.</p>
<p>The documentation generally refers to “files” in many places but none of
the apis explicitly operate on on-disk files. Instead this library
requires that the text being operated on resides in-memory and as such if
you want to perform operations on files, it is up to the user to load the
contents of those files into memory before passing their contents to the
apis provided by this library.</p>
<h3 id="utf-8-and-non-utf-8"><a class="doc-anchor" href="#utf-8-and-non-utf-8">§</a>UTF-8 and Non-UTF-8</h3>
<p>This library has support for working with both utf8 and non-utf8 texts.
Most of the API’s have two different variants, one for working with utf8
<code>str</code> texts (e.g. <a href="fn.create_patch.html"><code>create_patch</code></a>) and one for working with bytes <code>[u8]</code>
which may or may not be utf8 (e.g. <a href="fn.create_patch_bytes.html"><code>create_patch_bytes</code></a>).</p>
<h3 id="creating-a-patch"><a class="doc-anchor" href="#creating-a-patch">§</a>Creating a Patch</h3>
<p>A <a href="struct.Patch.html"><code>Patch</code></a> between two texts can be created by doing the following:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>diffy::create_patch;

<span class="kw">let </span>original = <span class="string">"The Way of Kings\nWords of Radiance\n"</span>;
<span class="kw">let </span>modified = <span class="string">"The Way of Kings\nWords of Radiance\nOathbringer\n"</span>;

<span class="kw">let </span>patch = create_patch(original, modified);</code></pre></div>
<p>A <a href="struct.Patch.html"><code>Patch</code></a> can the be output in the <a href="https://en.wikipedia.org/wiki/Diff#Unified_format">Unified Format</a> either by using its
<a href="https://doc.rust-lang.org/stable/std/fmt/trait.Display.html"><code>Display</code></a> impl or by using a <a href="struct.PatchFormatter.html"><code>PatchFormatter</code></a> to output the diff with
color.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// Without color
</span><span class="macro">print!</span>(<span class="string">"{}"</span>, patch);

<span class="comment">// With color
</span><span class="kw">let </span>f = PatchFormatter::new().with_color();
<span class="macro">print!</span>(<span class="string">"{}"</span>, f.fmt_patch(<span class="kw-2">&amp;</span>patch));</code></pre></div><div class="example-wrap"><pre class="language-console"><code>--- original
+++ modified
@@ -1,2 +1,3 @@
 The Way of Kings
 Words of Radiance
+Oathbringer</code></pre></div><h3 id="applying-a-patch"><a class="doc-anchor" href="#applying-a-patch">§</a>Applying a Patch</h3>
<p>Once you have a <a href="struct.Patch.html"><code>Patch</code></a> you can apply it to a base image in order to
recover the new text. Each hunk will be applied to the base image in
sequence. Similarly to GNU <code>patch</code>, this implementation can detect when
line numbers specified in the patch are incorrect and will attempt to find
the correct place to apply each hunk by iterating forward and backward
from the given position until all context lines from a hunk match the base
image.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>diffy::{apply, Diff};

<span class="kw">let </span>s = <span class="string">"\
--- a/skybreaker-ideals
+++ b/skybreaker-ideals
@@ -10,6 +10,8 @@
 First:
     Life before death,
     strength before weakness,
     journey before destination.
 Second:
-    I will put the law before all else.
+    I swear to seek justice,
+    to let it guide me,
+    until I find a more perfect Ideal.
"</span>;

<span class="kw">let </span>diff = Diff::from_str(s).unwrap();

<span class="kw">let </span>base_image = <span class="string">"\
First:
    Life before death,
    strength before weakness,
    journey before destination.
Second:
    I will put the law before all else.
"</span>;

<span class="kw">let </span>expected = <span class="string">"\
First:
    Life before death,
    strength before weakness,
    journey before destination.
Second:
    I swear to seek justice,
    to let it guide me,
    until I find a more perfect Ideal.
"</span>;

<span class="kw">let </span>(content, _stats) = apply(base_image, <span class="kw-2">&amp;</span>diff).unwrap();
<span class="macro">assert_eq!</span>(content, expected);</code></pre></div><h3 id="performing-a-three-way-merge"><a class="doc-anchor" href="#performing-a-three-way-merge">§</a>Performing a Three-way Merge</h3>
<p>Two files <code>A</code> and <code>B</code> can be merged together given a common ancestor or
original file <code>O</code> to produce a file <code>C</code> similarly to how <a href="https://en.wikipedia.org/wiki/Diff3">diff3</a>
performs a three-way merge.</p>
<div class="example-wrap"><pre class="language-console"><code>    --- A ---
  /           \
 /             \
O               C
 \             /
  \           /
    --- B ---</code></pre></div>
<p>If files <code>A</code> and <code>B</code> modified different regions of the original file <code>O</code>
(or the same region in the same way) then the files can be merged without
conflict.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>diffy::merge;

<span class="kw">let </span>original = <span class="string">"the final empire\nThe Well of Ascension\nThe hero of ages\n"</span>;
<span class="kw">let </span>a = <span class="string">"The Final Empire\nThe Well of Ascension\nThe Hero of Ages\n"</span>;
<span class="kw">let </span>b = <span class="string">"The Final Empire\nThe Well of Ascension\nThe hero of ages\n"</span>;
<span class="kw">let </span>expected = <span class="string">"\
The Final Empire
The Well of Ascension
The Hero of Ages
"</span>;

<span class="macro">assert_eq!</span>(merge(original, a, b).unwrap(), expected);</code></pre></div>
<p>If both files <code>A</code> and <code>B</code> modified the same region of the original file
<code>O</code> (and those modifications are different), it would result in a conflict
as it is not clear which modifications should be used in the merged
result.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>diffy::merge;

<span class="kw">let </span>original = <span class="string">"The Final Empire\nThe Well of Ascension\nThe hero of ages\n"</span>;
<span class="kw">let </span>a = <span class="string">"The Final Empire\nThe Well of Ascension\nThe Hero of Ages\nSecret History\n"</span>;
<span class="kw">let </span>b = <span class="string">"The Final Empire\nThe Well of Ascension\nThe hero of ages\nThe Alloy of Law\n"</span>;
<span class="kw">let </span>expected = <span class="string">"\
The Final Empire
The Well of Ascension
&lt;&lt;&lt;&lt;&lt;&lt;&lt; ours
The Hero of Ages
Secret History
||||||| original
The hero of ages
=======
The hero of ages
The Alloy of Law
&gt;&gt;&gt;&gt;&gt;&gt;&gt; theirs
"</span>;

<span class="macro">assert_eq!</span>(merge(original, a, b).unwrap_err(), expected);</code></pre></div></div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.ApplyConfig.html" title="struct diffy::ApplyConfig">Apply<wbr>Config</a></dt><dd>Configuration for patch application</dd><dt><a class="struct" href="struct.ApplyError.html" title="struct diffy::ApplyError">Apply<wbr>Error</a></dt><dd>An error returned when <a href="fn.apply.html" title="fn diffy::apply"><code>apply</code></a>ing a <code>Patch</code> fails</dd><dt><a class="struct" href="struct.ApplyStats.html" title="struct diffy::ApplyStats">Apply<wbr>Stats</a></dt><dd>Statistics about the changes made when applying a patch</dd><dt><a class="struct" href="struct.Diff.html" title="struct diffy::Diff">Diff</a></dt><dd>Representation of all the differences between two files</dd><dt><a class="struct" href="struct.DiffOptions.html" title="struct diffy::DiffOptions">Diff<wbr>Options</a></dt><dd>A collection of options for modifying the way a diff is performed</dd><dt><a class="struct" href="struct.FuzzyConfig.html" title="struct diffy::FuzzyConfig">Fuzzy<wbr>Config</a></dt><dd>Configuration for fuzzy matching behavior</dd><dt><a class="struct" href="struct.Hunk.html" title="struct diffy::Hunk">Hunk</a></dt><dd>Represents a group of differing lines between two files</dd><dt><a class="struct" href="struct.HunkRange.html" title="struct diffy::HunkRange">Hunk<wbr>Range</a></dt><dd>The range of lines in a file for a particular <code>Hunk</code>.</dd><dt><a class="struct" href="struct.MergeOptions.html" title="struct diffy::MergeOptions">Merge<wbr>Options</a></dt><dd>A collection of options for modifying the way a merge is performed</dd><dt><a class="struct" href="struct.ParserConfig.html" title="struct diffy::ParserConfig">Parser<wbr>Config</a></dt><dt><a class="struct" href="struct.PatchFormatter.html" title="struct diffy::PatchFormatter">Patch<wbr>Formatter</a></dt><dd>Struct used to adjust the formatting of a <code>Patch</code></dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.ConflictStyle.html" title="enum diffy::ConflictStyle">Conflict<wbr>Style</a></dt><dd>Style used when rendering a conflict</dd><dt><a class="enum" href="enum.HunkRangeStrategy.html" title="enum diffy::HunkRangeStrategy">Hunk<wbr>Range<wbr>Strategy</a></dt><dt><a class="enum" href="enum.Line.html" title="enum diffy::Line">Line</a></dt><dd>A line in either the old file, new file, or both.</dd><dt><a class="enum" href="enum.LineEnd.html" title="enum diffy::LineEnd">LineEnd</a></dt><dt><a class="enum" href="enum.LineEndHandling.html" title="enum diffy::LineEndHandling">Line<wbr>EndHandling</a></dt><dd>Configuration of line end handling</dd><dt><a class="enum" href="enum.ParsePatchError.html" title="enum diffy::ParsePatchError">Parse<wbr>Patch<wbr>Error</a></dt><dd>An error returned when parsing a <code>Patch</code> using <a href="struct.Patch.html#method.from_str"><code>Patch::from_str</code></a> fails</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.apply.html" title="fn diffy::apply">apply</a></dt><dd>Apply a <code>Diff</code> to a base image with default fuzzy matching</dd><dt><a class="fn" href="fn.apply_bytes.html" title="fn diffy::apply_bytes">apply_<wbr>bytes</a></dt><dd>Apply a non-utf8 <code>Diff</code> to a base image with default fuzzy matching</dd><dt><a class="fn" href="fn.apply_bytes_with_config.html" title="fn diffy::apply_bytes_with_config">apply_<wbr>bytes_<wbr>with_<wbr>config</a></dt><dd>Apply a non-utf8 <code>Diff</code> to a base image with custom fuzzy matching configuration</dd><dt><a class="fn" href="fn.apply_with_config.html" title="fn diffy::apply_with_config">apply_<wbr>with_<wbr>config</a></dt><dd>Apply a <code>Diff</code> to a base image with custom fuzzy matching configuration</dd><dt><a class="fn" href="fn.create_patch.html" title="fn diffy::create_patch">create_<wbr>patch</a></dt><dd>Create a patch between two texts.</dd><dt><a class="fn" href="fn.create_patch_bytes.html" title="fn diffy::create_patch_bytes">create_<wbr>patch_<wbr>bytes</a></dt><dd>Create a patch between two potentially non-utf8 texts</dd><dt><a class="fn" href="fn.merge.html" title="fn diffy::merge">merge</a></dt><dd>Merge two files given a common ancestor.</dd><dt><a class="fn" href="fn.merge_bytes.html" title="fn diffy::merge_bytes">merge_<wbr>bytes</a></dt><dd>Perform a 3-way merge between potentially non-utf8 texts</dd><dt><a class="fn" href="fn.patch_from_bytes.html" title="fn diffy::patch_from_bytes">patch_<wbr>from_<wbr>bytes</a></dt><dt><a class="fn" href="fn.patch_from_bytes_with_config.html" title="fn diffy::patch_from_bytes_with_config">patch_<wbr>from_<wbr>bytes_<wbr>with_<wbr>config</a></dt><dt><a class="fn" href="fn.patch_from_str.html" title="fn diffy::patch_from_str">patch_<wbr>from_<wbr>str</a></dt><dt><a class="fn" href="fn.patch_from_str_with_config.html" title="fn diffy::patch_from_str_with_config">patch_<wbr>from_<wbr>str_<wbr>with_<wbr>config</a></dt></dl><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><dl class="item-table"><dt><a class="type" href="type.ApplyResult.html" title="type diffy::ApplyResult">Apply<wbr>Result</a></dt><dd>Result of applying a patch with statistics</dd><dt><a class="type" href="type.Patch.html" title="type diffy::Patch">Patch</a></dt></dl><script type="text/json" id="notable-traits-data">{"&<Vec<T, A> as Index<I>>::Output":"<h3>Notable traits for <code><a class=\"struct\" href=\"https://doc.rust-lang.org/1.92.0/alloc/vec/struct.Vec.html\" title=\"struct alloc::vec::Vec\">Vec</a>&lt;<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.92.0/std/primitive.u8.html\">u8</a>, A&gt;</code></h3><pre><code><div class=\"where\">impl&lt;A&gt; <a class=\"trait\" href=\"https://doc.rust-lang.org/1.92.0/std/io/trait.Write.html\" title=\"trait std::io::Write\">Write</a> for <a class=\"struct\" href=\"https://doc.rust-lang.org/1.92.0/alloc/vec/struct.Vec.html\" title=\"struct alloc::vec::Vec\">Vec</a>&lt;<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.92.0/std/primitive.u8.html\">u8</a>, A&gt;<div class=\"where\">where\n    A: <a class=\"trait\" href=\"https://doc.rust-lang.org/1.92.0/core/alloc/trait.Allocator.html\" title=\"trait core::alloc::Allocator\">Allocator</a>,</div></div>","&mut <Vec<T, A> as Index<I>>::Output":"<h3>Notable traits for <code><a class=\"struct\" href=\"https://doc.rust-lang.org/1.92.0/alloc/vec/struct.Vec.html\" title=\"struct alloc::vec::Vec\">Vec</a>&lt;<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.92.0/std/primitive.u8.html\">u8</a>, A&gt;</code></h3><pre><code><div class=\"where\">impl&lt;A&gt; <a class=\"trait\" href=\"https://doc.rust-lang.org/1.92.0/std/io/trait.Write.html\" title=\"trait std::io::Write\">Write</a> for <a class=\"struct\" href=\"https://doc.rust-lang.org/1.92.0/alloc/vec/struct.Vec.html\" title=\"struct alloc::vec::Vec\">Vec</a>&lt;<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.92.0/std/primitive.u8.html\">u8</a>, A&gt;<div class=\"where\">where\n    A: <a class=\"trait\" href=\"https://doc.rust-lang.org/1.92.0/core/alloc/trait.Allocator.html\" title=\"trait core::alloc::Allocator\">Allocator</a>,</div></div>","<Vec<T, A> as IntoIterator>::IntoIter":"<h3>Notable traits for <code><a class=\"struct\" href=\"https://doc.rust-lang.org/1.92.0/alloc/vec/struct.Vec.html\" title=\"struct alloc::vec::Vec\">Vec</a>&lt;<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.92.0/std/primitive.u8.html\">u8</a>, A&gt;</code></h3><pre><code><div class=\"where\">impl&lt;A&gt; <a class=\"trait\" href=\"https://doc.rust-lang.org/1.92.0/std/io/trait.Write.html\" title=\"trait std::io::Write\">Write</a> for <a class=\"struct\" href=\"https://doc.rust-lang.org/1.92.0/alloc/vec/struct.Vec.html\" title=\"struct alloc::vec::Vec\">Vec</a>&lt;<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.92.0/std/primitive.u8.html\">u8</a>, A&gt;<div class=\"where\">where\n    A: <a class=\"trait\" href=\"https://doc.rust-lang.org/1.92.0/core/alloc/trait.Allocator.html\" title=\"trait core::alloc::Allocator\">Allocator</a>,</div></div>"}</script></section></div></main></body></html>